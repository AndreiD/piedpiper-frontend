(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{336:function(t,e,o){var content=o(392);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(12).default)("2e6fa683",content,!0,{sourceMap:!1})},391:function(t,e,o){"use strict";var r=o(336);o.n(r).a},392:function(t,e,o){var r=o(11);(t.exports=r(!1)).push([t.i,'.chat-box[data-v-65ac1630]{height:500px;width:100%;overflow:scroll}.chat-item[data-v-65ac1630]{border:none}.chat-status[data-v-65ac1630]{min-height:49px}.chat-status .chat-date[data-v-65ac1630]{display:block;font-size:10px;font-style:italic;color:#999;height:15px;left:10%;right:10%}.chat-status .chat-content-center[data-v-65ac1630]{padding:5px 10px;background-color:#e1e1f7;border-radius:6px;font-size:12px;color:#555;height:34px;left:10%;right:10%}.right-bubble[data-v-65ac1630]{position:relative;background:#dcf8c6;border-top-left-radius:.4em;border-bottom-left-radius:.4em;border-bottom-right-radius:.4em;padding:5px 10px 10px;left:15%}.right-bubble span.msg-name[data-v-65ac1630]{font-size:12px;font-weight:700;color:green;display:block}.right-bubble span.msg-date[data-v-65ac1630]{font-size:10px;display:block}.right-bubble[data-v-65ac1630]:after{content:"";position:absolute;right:0;top:0;width:0;height:0;border:27px solid transparent;border-left-color:#dcf8c6;border-right:0;border-top:0;margin-top:-.5px;margin-right:-27px}.left-bubble[data-v-65ac1630]{position:relative;background:#efefef;border-top-right-radius:.4em;border-bottom-left-radius:.4em;border-bottom-right-radius:.4em;padding:5px 10px 10px;left:5%}.left-bubble span.msg-name[data-v-65ac1630]{font-size:12px;font-weight:700;color:#00f;display:block}.left-bubble span.msg-date[data-v-65ac1630]{font-size:10px;display:block}.left-bubble[data-v-65ac1630]:after{content:"";position:absolute;left:0;top:0;width:0;height:0;border:27px solid transparent;border-right-color:#efefef;border-left:0;border-top:0;margin-top:-.5px;margin-left:-27px}footer.sticky-footer[data-v-65ac1630]{position:fixed;bottom:0;left:0;width:100%;padding:10px;background-color:#fff;border-top:1px solid #efefef}',""])},411:function(t,e,o){"use strict";o.r(e);var r=o(17),n=(o(36),o(28),{auth:!0,data:function(){return{user:null,showCallDialog:!1,message:"",myUser:null,name:null,id:null,isLoading:!1,chats:[]}},mounted:function(){this.name=this.$route.params.name,this.id=this.$route.params.id,this.getMyInfo()},computed:{mapsIframeURL:function(){return"https://maps.google.com/maps/embed/v1/place?key=AIzaSyB2F_Jls4pggjIuZhgL88HV2MnOEk0U_tY&q="+btoa(this.user.address+", "+this.user.city+", Bulgaria")}},methods:{getMyInfo:function(){var t=this;this.$axios.get("/user/me").then((function(e){t.myUser=e.data,t.loadUser(t.id)})).catch((function(e){console.log(e),t.isLoading=!1,t.flash(e,"error")}))},loadChat:function(){var t=this;this.isLoading=!0;var e=this;this.$axios.get("/user/chats?page=1&limit=100").then((function(o){t.isLoading=!1;var data=o.data;null!=data?(t.chats=data,t.chats=t.chats.filter((function(t){return t.from_user_id==e.myUser._id&&t.to_user_id==e.user._id||t.from_user_id==e.user._id&&t.to_user_id==e.myUser._id})),t.chats=t.chats.reverse()):console.log("no results found!")})).catch((function(e){t.isLoading=!1,console.log(e),t.$toast.error(e.response.data.error)}))},loadUser:function(){var t=this;this.isLoading=!0,this.$axios.get("/u/"+this.id).then((function(e){t.isLoading=!1;var data=e.data;null!=data?(t.user=data,t.loadChat(t.id)):console.log("no results found!")})).catch((function(e){t.isLoading=!1,console.log(e),t.$toast.error(e.response.data.error)}))},sendMessage:function(){var t=this;if(this.message.length>1e3)this.$toast.error("maximum 1000 characters allowed");else if(this.message.length<1)this.$toast.error("what's your message?");else{this.user._id==this.myUser._id&&this.$toast.info("did you just try to talk with yourself ?"),this.isLoading=!0;var e=this;this.$axios.post("/user/chat",{to_user_id:this.user._id,from_user_pic:this.user.pic_url,to_user_pic:this.myUser.pic_url,from_user_name:this.myUser.first_name+" "+this.myUser.last_name,to_user_name:this.user.first_name+" "+this.user.last_name,message:this.message,metadata:this.user.first_name+this.user.last_name}).then((function(o){console.log(o.status),t.$toast.success("Message Sent!"),e.isLoading=!1,t.message="",t.loadChat(t.id)})).catch((function(o){e.isLoading=!1,t.$toast.error(o.response.data.error),console.log(o)}))}},openPhone:function(){window.open("tel:"+this.user.phone,"_blank")},formatPhone:function(t){return t.replace(/[^0-9]/g,"").replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")},getFormattedDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=t.getDate(),c=r[t.getMonth()],l=t.getFullYear(),d=t.getHours(),h=t.getMinutes(),m=d>=12?"pm":"am";return d=(d%=12)||12,h<10&&(h="0".concat(h)),e?"".concat(e," at ").concat(d,":").concat(h," ").concat(m):o?"".concat(n,". ").concat(c," at ").concat(d,":").concat(h," ").concat(m):"".concat(n,". ").concat(c," ").concat(l,". at ").concat(d,":").concat(h," ").concat(m)},timeAgo:function(t){if(!t)return null;var e="object"===Object(r.a)(t)?t:new Date(1e3*t),o=new Date,n=new Date(o-864e5),c=Math.round((o-e)/1e3),l=Math.round(c/60),d=o.toDateString()===e.toDateString(),h=n.toDateString()===e.toDateString(),m=o.getFullYear()===e.getFullYear();return c<5?"now":c<60?"".concat(c," seconds ago"):c<90?"about a minute ago":l<60?"".concat(l," minutes ago"):d?this.getFormattedDate(e,"Today"):h?this.getFormattedDate(e,"Yesterday"):m?this.getFormattedDate(e,!1,!0):this.getFormattedDate(e)}}}),c=(o(391),o(21)),l=o(73),d=o.n(l),h=o(313),m=o(316),f=o(315),v=o(400),_=o(308),x=o(404),y=o(329),w=o(300),C=o(177),k=o(309),D=o(334),L=o(346),V=o(317),M=o(401),$=o(402),S=o(345),component=Object(c.a)(n,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-layout",{attrs:{"align-center":"","justify-center":""}},[o("v-flex",{attrs:{xs12:"",sm8:"",md8:"","mt-5":""}},[o("v-container",{attrs:{fluid:""}},[t.user?o("v-row",[o("v-col",{attrs:{cols:12}},[o("v-card",{attrs:{outlined:""}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[t._v("\n                  "+t._s(t.user.city)+" - "+t._s(t.user.country)+"\n                ")]),t._v(" "),o("v-list-item-title",{staticClass:"headline mb-1"},[t._v(t._s(t.user.first_name)+"\n                  "+t._s(t.user.last_name))]),t._v(" "),o("v-list-item-subtitle",[t._v(t._s(t._f("truncate")(t.user.paragraph,2e3,"...")))]),t._v(" "),o("v-list-item-subtitle",{staticClass:"headline"},[t._v(t._s(t._f("truncate")(t.user.offers,2e3,"...")))])],1),t._v(" "),o("v-list-item-avatar",{attrs:{size:"256",tile:"",color:"grey"}},[o("img",{staticStyle:{"object-fit":"cover"},attrs:{src:t.user.pic_url,alt:t.user.last_name}})])],1),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{elevation:0,color:"accent","min-width":"220"},on:{click:function(e){t.showCallDialog=!t.showCallDialog}}},[o("v-icon",{attrs:{left:""}},[t._v("mdi-phone")]),t._v("call\n              ")],1),t._v(" "),o("v-spacer")],1)],1)],1),t._v(" "),o("v-col",{attrs:{cols:12}},[t.chats?o("v-card",{staticStyle:{"min-height":"300px"},attrs:{outlined:""}},[o("v-card-text",[t._l(t.chats,(function(e){return[o("v-list-item",{key:e.message,on:{click:function(o){return t.goToUser(e.from_user_name,e.to_user_id)}}},[o("v-list-item-avatar",[o("v-img",{attrs:{src:e.from_user_pic}})],1),t._v(" "),o("v-list-item-content",[o("v-list-item-title",{domProps:{innerHTML:t._s(e.message)}}),t._v(" "),o("v-list-item-subtitle",{domProps:{innerHTML:t._s(t.timeAgo(e.created_at))}})],1)],1)]})),t._v(" "),o("v-text-field",{ref:"message",attrs:{outlined:"",placeholder:"Type Your Message"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),t._v(" "),o("v-btn",{staticClass:"primary",on:{click:function(e){return t.sendMessage()}}},[t._v("SEND MESSAGE")])],2)],1):t._e()],1)],1):t._e()],1),t._v(" "),t.user?o("div",[o("v-dialog",{attrs:{width:"500"},model:{value:t.showCallDialog,callback:function(e){t.showCallDialog=e},expression:"showCallDialog"}},[o("v-card",{staticClass:"text-center"},[o("v-card-title",{staticClass:"text-center",attrs:{"primary-title":""}},[o("v-icon",{attrs:{left:""}},[t._v("mdi-phone")]),t._v("Phone Contact\n          ")],1),t._v(" "),o("v-card-text",{staticClass:"mt-5 text-center"},[o("p",{staticClass:"title"},[t._v("\n              You can reach "+t._s(t.user.first_name)+" "+t._s(t.user.last_name)+" via the\n              number below\n            ")]),t._v(" "),o("v-btn",{staticClass:"ma-5 primary",attrs:{"x-large":""},on:{click:function(e){return t.openPhone()}}},[t._v(t._s(t.formatPhone(t.user.phone)))])],1),t._v(" "),o("v-card-actions",[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){t.showCallDialog=!1}}},[t._v("CLOSE")])],1)],1)],1)],1):t._e()],1)],1)}),[],!1,null,"65ac1630",null);e.default=component.exports;d()(component,{VBtn:h.a,VCard:m.a,VCardActions:f.a,VCardText:f.b,VCardTitle:f.c,VCol:v.a,VContainer:_.a,VDialog:x.a,VFlex:y.a,VIcon:w.a,VImg:C.a,VLayout:k.a,VListItem:D.a,VListItemAvatar:L.a,VListItemContent:V.a,VListItemSubtitle:V.b,VListItemTitle:V.c,VRow:M.a,VSpacer:$.a,VTextField:S.a})}}]);